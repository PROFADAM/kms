use std::num::Wrapping;

use lazy_static::lazy_static;

use crate::poly_shamir::{ShamirPolynomial, Z64Poly};

// lagrange_constants[i] - gamma_i(X) = (a_0, ..., a_{N-1}), a_i \in Z_{2^64}[X]
// lagrange_constants[i][j] = gamma_i(X)[j] \in Z_{2^64}[X] = (a_{j, 0}, ..., a_{j, 7}), a_{j, k} \in Z_{2^64}
lazy_static! {
    static ref _LAGRANGE_CONSTANTS: Vec<Vec<Vec<u64>>> = vec![
        vec![
            vec![
                4217037493698935073_u64,
                13308487360814454694,
                1592009912785600092,
                2589252077255231610,
                6336736085441559914,
                6716850811808908250,
                5084593457407941864,
                880971777580795556
            ],
            vec![
                3774315635929905831_u64,
                10209434356431250017,
                1444435960195923675,
                1261086503948143889,
                16371764861539555988,
                11586791247268229875,
                15857491996454320009,
                10178130790730409573
            ],
            vec![
                6345679961356085758_u64,
                13675186273310014269,
                2115226653785361917,
                590295810358705651,
                9887454823508319664,
                10133411411157780349,
                11609150937054544477,
                8165758709962094843
            ],
            vec![
                7427888947013712783_u64,
                2803905099203851848,
                4525601212750076671,
                3836922767331586740,
                12002681477293681596,
                4378027260160400256,
                7821419487252849893,
                16183943467334513284
            ],
            vec![
                6546917169432917237_u64,
                6139970815321991353,
                17834088573564531353,
                4547960902536391274,
                13710961776968117630,
                10714763345601960164,
                14538270299061758128,
                2821792851032903542
            ],
            vec![
                17297456018692980755_u64,
                9283743199277825260,
                2598195953169757445,
                1583066036871074246,
                15057015102104257038,
                13760153094498009776,
                17158825942017830195,
                16309157730137875082
            ],
            vec![
                9632554359944333125_u64,
                11528656053823811894,
                2651859208656912515,
                3743012070229065370,
                16997836175556365022,
                17579188110000544818,
                14359392780771241279,
                2866512230605532740
            ],
            vec![
                16818958657265848172_u64,
                9847207381892953366,
                16599833697359964998,
                10209434356431250038,
                5965565234988737416,
                15110678357591412106,
                5138256712895096912,
                16854734160923951540
            ],
            vec![
                1726168051503487731_u64,
                15437129828471605379,
                5978981048860526182,
                8532457622457654414,
                14350448904856715428,
                2253856730460512486,
                666318755632175323,
                17972718650239681920
            ],
        ],
        vec![
            vec![
                3214545662931647077_u64,
                44913811657727594,
                5883709327162316106,
                17663960499103441936,
                11350361831788590180,
                11157874067541186166,
                4388721024840811579,
                3073387969150217470
            ],
            vec![
                6339263702547838984_u64,
                12828240110621436640,
                14143573166312030736,
                14472941118468699840,
                14577740012336730923,
                3520387332791411260,
                12299968135409116669,
                12578006017099811343
            ],
            vec![
                14669706388588268311_u64,
                11790944936621537114,
                7385113888292067444,
                10591104539479385445,
                151851458461840928,
                7594711676028129633,
                17229793653078741840,
                451276869513358370
            ],
            vec![
                10770759786110295877_u64,
                13638827473396615708,
                15798967938839705208,
                8251308827405385478,
                15632145209825288369,
                6371344996589072866,
                16840540618711769131,
                4799361588568606782
            ],
            vec![
                10488444398547436672_u64,
                968855080045266920,
                10090636352436135049,
                16494062643066442039,
                643764633760762404,
                10546190727821657912,
                4194094507657325315,
                14470802365532617521
            ],
            vec![
                5363992363694325269_u64,
                921802515451457007,
                16224579773120076327,
                9408374165825891851,
                8078069839582721888,
                12911651475128645004,
                474803151810263258,
                710065974779312602
            ],
            vec![
                1505682067001915868_u64,
                1984762724684343655,
                7898414592951811518,
                15478154998427365233,
                2138752936082256,
                12578006017099811360,
                5958565679925195456,
                11957767665635953989
            ],
            vec![
                9401957907017645084_u64,
                11275505479025710844,
                1351691855603992648,
                8155064945281683518,
                13953224155000708959,
                13942530390320297619,
                6392732525949895623,
                13493392273743021581
            ],
            vec![
                12032624018398833322_u64,
                1886380089624559366,
                13457033473829623044,
                10165492705199014356,
                9397680401145480557,
                13611023685227546260,
                6007756997455087593,
                12252915570815306806
            ],
        ],
        vec![
            vec![
                2570893595114889089_u64,
                8869971255653182292,
                3899059168421976804,
                9460267066011887944,
                10011727625689099802,
                12303007415897233582,
                8186470843658891537,
                4264110524828018458
            ],
            vec![
                6330145861083488242_u64,
                8776766654017597195,
                4116536572238342050,
                13941854994656271648,
                8233073144476684096,
                466023008177925518,
                13670008239885815093,
                11145716945588718554
            ],
            vec![
                3650513564060416519_u64,
                4970912087231205481,
                4388383327008798587,
                16776828294405318515,
                8776766654017597183,
                7805885386980252369,
                3922360318830873087,
                17903050564168638520
            ],
            vec![
                6205873058902708098_u64,
                4023331970602756944,
                7829186537389148643,
                6384515212037579534,
                17134112600675061417,
                1833023832166507008,
                16629254341815642106,
                551460559677211844
            ],
            vec![
                1693216929713129409_u64,
                7580640933027588366,
                5677713649634392533,
                13040877178845615690,
                17996255165804223620,
                3510706661607038899,
                5335963443637247125,
                9685511519964551974
            ],
            vec![
                16209833634455509116_u64,
                6671896067080633623,
                11487467151585863916,
                11541836502539955223,
                12644757621894378956,
                6159270758084915544,
                16372941687317783087,
                12217569864397947222
            ],
            vec![
                2586427695387486579_u64,
                3930127368967171839,
                11736012755947424213,
                10866103140681963209,
                598062860495004426,
                4753434683414840228,
                18423442923300655363,
                54369350954091283
            ],
            vec![
                5110718989684583184_u64,
                5483537396226923550,
                17949652864986431068,
                5040815538457894362,
                1957296634347287145,
                10190369778823971273,
                6967043972259986413,
                16947703397403891247
            ],
            vec![
                10982608892726444612_u64,
                5033048488321595558,
                6702964267625828650,
                5180622440911271955,
                14881668061148421435,
                8318510695975970427,
                2726234597840864269,
                1017483567855137362
            ],
        ],
        vec![
            vec![
                17646737909670779475_u64,
                10904938391363457028,
                380585456678639166,
                17988488115667924855,
                5188389491047570723,
                8800067804426493469,
                372818406542340420,
                13887485643702180342
            ],
            vec![
                163108052862273946_u64,
                10850569040409365744,
                2967013152066125759,
                9227255561922925169,
                11836984407719308047,
                16652555492224538341,
                11565137652948851472,
                11137949895452419761
            ],
            vec![
                4318479875782109778_u64,
                17607902658989285739,
                5646645449089197567,
                7130152025122260460,
                2438853742797810299,
                7836953587525447502,
                1390301974397477858,
                10283574380459556378
            ],
            vec![
                9584539868192668038_u64,
                6897140521033297499,
                17110811450266165043,
                15161281866055176633,
                2493223093751901372,
                5250525892137960723,
                11114648745043523495,
                3580610112833727741
            ],
            vec![
                11736012755947424252_u64,
                1568944127532349317,
                12326308566306129887,
                5110718989684583202,
                8419482347747854338,
                31068200545195044,
                1157290470308514986,
                10827267890000469406
            ],
            vec![
                12714661073121067750_u64,
                11332126148859888746,
                11681643404993332909,
                5134020140093479387,
                5654412499225496265,
                7712680785344667271,
                15207884166872969342,
                3867990967876781770
            ],
            vec![
                6415583412582774603_u64,
                14811764609921732589,
                12170967563580154691,
                12450581368486909999,
                4419451527553993620,
                3215558756427686042,
                18322471271528771464,
                13817582192475491516
            ],
            vec![
                4186440023465030872_u64,
                7945692289433630033,
                14664190657332056178,
                15471963871507127099,
                8668027952109414561,
                9289391963013315268,
                13988457295474064185,
                9172886210968833882
            ],
            vec![
                7021413323214077750_u64,
                10314642581004751385,
                15285554668235956880,
                4559258430007371276,
                6221407159175305623,
                14998173813192902804,
                667966311721693242,
                15658373074778297284
            ],
        ],
        vec![
            vec![
                2721919569987364957_u64,
                14954160529087209854,
                17987625110097225000,
                14314673401198612057,
                8674068991104313609,
                4902734647145916383,
                4820749117929429482,
                229559481806163300
            ],
            vec![
                6722813395751925464_u64,
                12215843853256547506,
                11805916207174113057,
                1721696113546224840,
                17052990077029274405,
                18282773015276577863,
                15413279492699536503,
                245956587649460720
            ],
            vec![
                6230900220453004080_u64,
                6722813395751925410,
                17790859839977656355,
                6394871278885977800,
                1557725055113250927,
                15495265021916023266,
                15085337375833588815,
                12625771499338981975
            ],
            vec![
                5230676764011864041_u64,
                9969440352724806693,
                16774239277693219020,
                15692030292035592001,
                7149138147677657454,
                10100617199471185663,
                1164194514874113930,
                13134081780481200703
            ],
            vec![
                705075551261787264_u64,
                17233358241305545506,
                2967876157636825644,
                14413056036258396306,
                1098606091500924366,
                12740551240242063666,
                606692916202003091,
                13888348649272880263
            ],
            vec![
                9871057717665022275_u64,
                15806810032938673538,
                8756054520320800492,
                11166429079285515247,
                3082655898539907269,
                8247744239178581697,
                4394424366003697587,
                1770887431076116942
            ],
            vec![
                1852872960292603858_u64,
                12970110722048226957,
                12232240959099844874,
                11707533572114328759,
                10608927480613404376,
                14462247353788288484,
                2738316675830662327,
                6181708902923111950
            ],
            vec![
                15954383985528349980_u64,
                11248414608502002151,
                12150255429883358002,
                10969663809165946689,
                7985390545685823673,
                15118131587520183638,
                524707386985516141,
                15446073704386131222
            ],
            vec![
                6050532056176732929_u64,
                9559512706642372081,
                10215396940374267252,
                5853766786057164381,
                16577474007573650385,
                11330400137718489036,
                10592530374770106972,
                10264588257904159389
            ],
        ],
        vec![
            vec![
                379502776962670253_u64,
                10323539383888148149,
                16315700881464817682,
                4986728625690577508,
                8375610282735548583,
                1750787246783998352,
                10575333027397615177,
                15213909514857491964
            ],
            vec![
                17437498286302003829_u64,
                3320766981001187406,
                13716845905859253051,
                12859410643842999187,
                5096361715190212698,
                13337672640114486386,
                13300014215211219683,
                15251191355511726008
            ],
            vec![
                1491273626169361657_u64,
                13998813362322462557,
                9558649701071672230,
                13211752281844188344,
                178642153134871460,
                14340563568319607912,
                9991015491992303105,
                7842131620949646559
            ],
            vec![
                1482470969348223054_u64,
                5975968374868264839,
                8930036443373892699,
                17457221886345089788,
                15351315692723286371,
                4599129287373704933,
                8371326636902802007,
                15146783372467419078
            ],
            vec![
                4384429192393955577_u64,
                10767343921373146300,
                3220830935914143370,
                6692514054715172116,
                10099707120869356632,
                9235681634495031094,
                4581100316451265967,
                8398487775864283094
            ],
            vec![
                15103570329890920513_u64,
                3347033732371215951,
                2117956889590848768,
                3580468893740340456,
                6771502600949774073,
                6142136174753929199,
                4778430462944383530,
                16867020222048642284
            ],
            vec![
                14580447734953416859_u64,
                6116528445819707832,
                4383534804802503005,
                10448941938816026300,
                909874618694052748,
                3846996395993210588,
                13614414990122367606,
                6140159107446507709
            ],
            vec![
                10982420600601928280_u64,
                6702823048532441403,
                369617440425562739,
                4067957204113127980,
                14101385497152735238,
                3736845503151155454,
                567418317229971133,
                15825905992566705046
            ],
            vec![
                7945362778215726442_u64,
                13234159044661632027,
                15173803292335512920,
                481980765730684785,
                12902576613388368661,
                16797163843853082546,
                8007922836586278256,
                9994875480544887954
            ],
        ],
        vec![
            vec![
                13623489009122956217_u64,
                9817842117473898707,
                10466826921643246850,
                1926186898774625288,
                4361177884018019521,
                8961182175970359158,
                14635905303627139321,
                14744934750727589808
            ],
            vec![
                14464573315326431411_u64,
                1758316162762820568,
                12162840543205809997,
                14450728306170818650,
                15316041378396616174,
                14341698859070368162,
                10773147749211179173,
                9618820110861965277
            ],
            vec![
                15272775724785326306_u64,
                15104904988773521577,
                15108366241062424771,
                17768338625084526363,
                3220695254824418384,
                14362466372803787305,
                2734389308233520172,
                15573904673919903841
            ],
            vec![
                15774657306676288857_u64,
                6829050766005994065,
                5745678799579295552,
                15575635300064355436,
                6493309293982384615,
                11702493988781685719,
                11133117987257110942,
                7606101904864760236
            ],
            vec![
                10665848928255180241_u64,
                17751032363640010409,
                14118448086436112402,
                4861328839764530444,
                4857867587475627315,
                655907308747154500,
                7950496507610627678,
                14374580755814948434
            ],
            vec![
                8249894830600753654_u64,
                1528142885550758409,
                2364035313320878853,
                14483610202915399002,
                12258024981150647717,
                3622200520337188453,
                14718975358560815853,
                13334474442999539888
            ],
            vec![
                5884128891135423174_u64,
                17681807317861946616,
                8120097869766883948,
                10973900381967564232,
                3383374112402868300,
                11856519715637877694,
                9414606225816677041,
                4118890223794796231
            ],
            vec![
                1503914119528436038_u64,
                6072767140880647027,
                780512391147669369,
                16562092202401764540,
                837623053914572028,
                3712193079848671344,
                6529652443015868159,
                8395267426734687526
            ],
            vec![
                6794438243116962182_u64,
                15689856625598160702,
                4920170128675884722,
                14078643685113725741,
                4612118674963500794,
                4572314273641114129,
                14343429485214819741,
                4466746078829566839
            ],
        ],
        vec![
            vec![
                2544057352368259688_u64,
                7841840875757378707,
                4897261253526397474,
                18291444606011043283,
                13823212496198774028,
                14470282074101595739,
                10353284001558066602,
                12621834901735736100
            ],
            vec![
                9942950235207067480_u64,
                15846134473943665672,
                13851599379970832057,
                10745582335982354167,
                3180757018413527441,
                3714966696682845801,
                9130349727839739607,
                3652479555360513543
            ],
            vec![
                4565133328892402966_u64,
                13921424376145639080,
                9943822470783871084,
                12618950524828316775,
                5153047797676343221,
                16656542854861354859,
                4823813479955871778,
                4230347162500530805
            ],
            vec![
                17850628744502436733_u64,
                7230172986265458824,
                4628511165803746314,
                15979300387005401073,
                12123446877155039826,
                9490333810894826990,
                16756633041050331379,
                3291069436362398045
            ],
            vec![
                14941252365551126881_u64,
                9458670274955940605,
                12029757700199008270,
                11247533142919094797,
                6527764906767652906,
                7074896593582209846,
                10904449201039958719,
                9541892624990328911
            ],
            vec![
                16931744716850521568_u64,
                6025744874785134220,
                1599749272903587624,
                2678981581592757908,
                8131344632204293398,
                2229840254578576220,
                7426610591168344540,
                13971884819514795718
            ],
            vec![
                16322730454113427466_u64,
                807224028811898250,
                2575993173487206458,
                13057352739740794830,
                9482312935590675332,
                14010346254949087966,
                2376638886655538320,
                11957177547202234312
            ],
            vec![
                7150305743449780680_u64,
                5617506319819684496,
                4053181810342258051,
                14837502481942016727,
                7927924527683926978,
                703806425422522805,
                12544496680592483219,
                15692944062639862351
            ],
            vec![
                1984917427612734618_u64,
                7038258084353406610,
                1760355994111747516,
                11223816642235530136,
                7437165103147973334,
                5435961329765186238,
                17917444758687423916,
                17274090258241358295
            ],
        ],
        vec![
            vec![
                8422048851271153020_u64,
                16168026642852301055,
                12364198263057987290,
                5012719078834413599,
                5665691606814730104,
                4724190051162515365,
                15369101111875970482,
                8870781730450013466
            ],
            vec![
                8612307809827271277_u64,
                16427648736103887332,
                18024959481525327698,
                13553164790009320690,
                568007753445848308,
                10330852076941374874,
                8671067232597531487,
                18425469110292733301
            ],
            vec![
                17242513604751231089_u64,
                12887562363111718469,
                1849908723767156509,
                7151426988539078727,
                5528451207884651166,
                16454664562664926501,
                7000813755461285332,
                15157904887735046789
            ],
            vec![
                17906224923789560599_u64,
                16419138750737160044,
                10890687542852508930,
                12342247903977143013,
                3854347975463457060,
                1614735953553310690,
                2402584995639615197,
                9493564072248368751
            ],
            vec![
                12625779003735248931_u64,
                2318160537636367688,
                13968060346420479572,
                15825668580757532212,
                10432566663943687253,
                830466508486343723,
                6071874559159953839,
                8225035936074774935
            ],
            vec![
                8938253757286208796_u64,
                422932764813068094,
                16957294015833060130,
                14210189691973793144,
                2109193119186729860,
                13001298992933693300,
                11700824641851670688,
                13184668915716746572
            ],
            vec![
                15006548719426824932_u64,
                3955995022899366832,
                12017855366545465242,
                3508140158083740148,
                8938253757286208768,
                9931423081236410900,
                7025870934596649224,
                16692809073800486734
            ],
            vec![
                2677876268296604174_u64,
                9593522630524213594,
                5868040147756913411,
                6919225959246947127,
                12390538693955000466,
                1983029209146676957,
                2687466886725773063,
                17298301286599776917
            ],
            vec![
                802167430163655262_u64,
                14040732919869674972,
                292716480788859298,
                13710937217125789420,
                5853181443148341863,
                14916315858712954154,
                12857372176929757152,
                3331929429339362231
            ],
        ]
    ];
    pub static ref LAGRANGE_POLYS: Vec<ShamirPolynomial<Z64Poly>> = _LAGRANGE_CONSTANTS
        .iter()
        .map(|x| {
            let polys: Vec<Z64Poly> = x
                .iter()
                .map(|inner| {
                    let coefs: Vec<Wrapping<u64>> =
                        inner.iter().map(|entry| Wrapping(*entry)).collect();
                    Z64Poly::from_vec(coefs)
                })
                .collect();
            ShamirPolynomial::from_vec_poly(polys)
        })
        .collect();
}
